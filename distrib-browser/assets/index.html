<html>
  <head>
    <!-- TODO ACY comment rendre ca configurable ? -->
    <!-- Browser title and icon -->
    <title>Nouv√®l</title>
    <link rel="icon" href="favicon.ico" />

    <!-- TODO ACY comment rendre ca configurable ? -->
    <!-- PWA configuration -->
    <!-- Inspired by https://github.com/yannbertrand/pwa-demo -->
    <!-- This part was generated with https://realfavicongenerator.net/ -->
    <link
      rel="apple-touch-icon"
      sizes="180x180"
      href="icons/apple-touch-icon.png"
    />
    <link
      rel="icon"
      type="image/png"
      sizes="32x32"
      href="icons/favicon-32x32.png"
    />
    <link
      rel="icon"
      type="image/png"
      sizes="16x16"
      href="icons/favicon-16x16.png"
    />
    <link rel="manifest" href="site.webmanifest" />
    <link rel="mask-icon" href="icons/safari-pinned-tab.svg" color="#5bbad5" />
    <meta name="msapplication-TileColor" content="#da532c" />
    <meta name="theme-color" content="#ffffff" />
    <!-- This part was generated with https://appsco.pe/developer/splash-screens -->
    <meta name="apple-mobile-web-app-capable" content="yes" />
    <meta
      name="apple-mobile-web-app-status-bar-style"
      content="black-translucent"
    />
    <link
      href="splashscreens/iphone5_splash.png"
      media="(device-width: 320px) and (device-height: 568px) and (-webkit-device-pixel-ratio: 2)"
      rel="apple-touch-startup-image"
    />
    <link
      href="splashscreens/iphone6_splash.png"
      media="(device-width: 375px) and (device-height: 667px) and (-webkit-device-pixel-ratio: 2)"
      rel="apple-touch-startup-image"
    />
    <link
      href="splashscreens/iphoneplus_splash.png"
      media="(device-width: 621px) and (device-height: 1104px) and (-webkit-device-pixel-ratio: 3)"
      rel="apple-touch-startup-image"
    />
    <link
      href="splashscreens/iphonex_splash.png"
      media="(device-width: 375px) and (device-height: 812px) and (-webkit-device-pixel-ratio: 3)"
      rel="apple-touch-startup-image"
    />
    <link
      href="splashscreens/iphonexr_splash.png"
      media="(device-width: 414px) and (device-height: 896px) and (-webkit-device-pixel-ratio: 2)"
      rel="apple-touch-startup-image"
    />
    <link
      href="splashscreens/iphonexsmax_splash.png"
      media="(device-width: 414px) and (device-height: 896px) and (-webkit-device-pixel-ratio: 3)"
      rel="apple-touch-startup-image"
    />
    <link
      href="splashscreens/ipad_splash.png"
      media="(device-width: 768px) and (device-height: 1024px) and (-webkit-device-pixel-ratio: 2)"
      rel="apple-touch-startup-image"
    />
    <link
      href="splashscreens/ipadpro1_splash.png"
      media="(device-width: 834px) and (device-height: 1112px) and (-webkit-device-pixel-ratio: 2)"
      rel="apple-touch-startup-image"
    />
    <link
      href="splashscreens/ipadpro3_splash.png"
      media="(device-width: 834px) and (device-height: 1194px) and (-webkit-device-pixel-ratio: 2)"
      rel="apple-touch-startup-image"
    />
    <link
      href="splashscreens/ipadpro2_splash.png"
      media="(device-width: 1024px) and (device-height: 1366px) and (-webkit-device-pixel-ratio: 2)"
      rel="apple-touch-startup-image"
    />
  </head>
  <body>
    <button id="buttonInstall">Install</button>
    <script src="bundle.js"></script>
    <script>
      // --- Custom Install Button ---
      // From https://web.dev/customize-install/
      // and https://developer.mozilla.org/fr/docs/Web/Progressive_web_apps/ajouter_a_lecran_daccueil_a2hs

      // Hide install button by default
      const buttonInstall = document.getElementById("buttonInstall");
      buttonInstall.style.display = "none";

      let deferredPrompt;
      window.addEventListener("beforeinstallprompt", (e) => {
        console.log("[pwa] app can be installed");
        // Prevent the mini-infobar from appearing on mobile
        e.preventDefault();
        // Stash the event so it can be triggered later.
        deferredPrompt = e;
        // Update UI notify the user they can install the PWA
        buttonInstall.style.display = "block";
      });
      buttonInstall.addEventListener("click", (e) => {
        console.log("[pwa] install button clicked");
        // Hide the app provided install promotion
        buttonInstall.style.display = "none";
        // Show the install prompt
        deferredPrompt.prompt();
        // Wait for the user to respond to the prompt
        deferredPrompt.userChoice.then((choiceResult) => {
          if (choiceResult.outcome === "accepted") {
            console.log("[pwa] user accepted to install");
          } else {
            console.log("[pwa] user refused to install");
          }
          deferredPrompt = null;
        });
      });
      window.addEventListener("appinstalled", (evt) => {
        console.log("[pwa] app is installed");
      });
    </script>
  </body>
</html>
