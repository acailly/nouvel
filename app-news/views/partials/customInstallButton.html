<button id="buttonInstall">Installer</button>

<script>
  // --- Custom Install Button ---
  // From https://web.dev/customize-install/
  // and https://developer.mozilla.org/fr/docs/Web/Progressive_web_apps/ajouter_a_lecran_daccueil_a2hs

  // Hide install button by default
  const buttonInstall = document.getElementById("buttonInstall");
  const buttonInstallDisplay = buttonInstall.style.display;
  buttonInstall.style.display = "none";

  let deferredPrompt;
  window.addEventListener("beforeinstallprompt", (e) => {
    console.log("[pwa] app can be installed");
    // Prevent the mini-infobar from appearing on mobile
    e.preventDefault();
    // Stash the event so it can be triggered later.
    deferredPrompt = e;
    // Update UI notify the user they can install the PWA
    buttonInstall.style.display = buttonInstallDisplay;
  });
  buttonInstall.addEventListener("click", (e) => {
    console.log("[pwa] install button clicked");
    // Hide the app provided install promotion
    buttonInstall.style.display = "none";
    // Show the install prompt
    deferredPrompt.prompt();
    // Wait for the user to respond to the prompt
    deferredPrompt.userChoice.then((choiceResult) => {
      if (choiceResult.outcome === "accepted") {
        console.log("[pwa] user accepted to install");
      } else {
        console.log("[pwa] user refused to install");
      }
      deferredPrompt = null;
    });
  });
  window.addEventListener("appinstalled", (evt) => {
    console.log("[pwa] app is installed");
  });
</script>
